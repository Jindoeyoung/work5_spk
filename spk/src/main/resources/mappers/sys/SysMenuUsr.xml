<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spk.api.mapper.SysMenuUsrMapper">

	<!-- 시스템메뉴유저 조회  -->
    <select id="getSysMenuUsrList" resultType="com.spk.api.entity.SysMenuUsr">
		SELECT a.MENU_ID, a.MENU_NM, a.SEQ, a.LEVEL, a.USE_YN, a.PARENT_MENU_ID, a.ISDIRECTORY 
		FROM SYS_MENU_MST a left join SYS_MENU_USR b on a.DIVISION = b.DIVISION and a.MENU_ID = b.MENU_ID and a.SEQ = b.SEQ
		WHERE b.SPIKE_ID = #{SYS_MENU_USR.spike_id}
		<!--AND b.USE_YN = 'Y'-->
		ORDER BY a.DIVISION DESC, a.SEQ   
    </select>
    
	<!-- 시스템메뉴유저 조회  -->
    <select id="getSysMenuUsrList2" resultType="com.spk.api.entity.SysMenuUsr">
		SELECT JSON_OBJECT('menuCd', MENU_ID, 'menuNm', MENU_NM) AS JSON_DATA, LEVEL
		FROM SYS_MENU_USR    
        WHERE SPIKE_ID = #{SYS_MENU_USR.spike_id}
          AND DIVISION = 'U'
          <!--  AND SEQ <![CDATA[ <= ]]> 25 -->
         ORDER BY DIVISION DESC, SEQ    
    </select>    
    
	<!-- 시스템메뉴유저 상세조회  -->
    <select id="getSysMenuUsrInfo" resultType="com.spk.api.entity.SysMenuUsr">
        SELECT * FROM SYS_MENU_USR 
        WHERE SPIKE_ID = #{SYS_MENU_USR.spike_id}
          AND DIVISION = #{SYS_MENU_USR.division}
		  AND MENU_ID = #{SYS_MENU_USR.menu_id}	
    </select>    
    
	<!-- 시스템메뉴유저 수정  -->
    <update id="updateSysMenuUsr" parameterType="com.spk.api.entity.SysMenuUsr">
        UPDATE SYS_MENU_USR
           SET USE_YN =  #{SYS_MENU_USR.use_yn} 
         WHERE SPIKE_ID = #{SYS_MENU_USR.spike_id}
           AND DIVISION = #{SYS_MENU_USR.division}
           AND MENU_ID = #{SYS_MENU_USR.menu_id}
    </update>    
    
</mapper>